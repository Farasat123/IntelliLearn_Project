{"openapi":"3.1.0","info":{"title":"RAG Ingestion Pipeline","description":"6 Clean APIs: Upload, Ingest, Topics CRUD, Documents CRUD","version":"3.0.0"},"paths":{"/":{"get":{"summary":"Root","description":"Redirect to API documentation.","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/upload":{"post":{"summary":"Upload File","description":"Upload a file to Supabase Storage and create a document record.\n\nSupports: PDF, DOCX, PPTX, DOC, PPT, ODT, TXT, RTF\nNon-PDF files are automatically converted to PDF before storage.\n\nReturns a document_id to use with /ingest.","operationId":"upload_file_upload_post","parameters":[{"name":"user_id","in":"query","required":true,"schema":{"type":"string","title":"User Id"}},{"name":"topic_id","in":"query","required":true,"schema":{"type":"string","title":"Topic Id"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_file_upload_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UploadResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/ingest":{"post":{"summary":"Ingest Documents","description":"Queue document(s) for background ingestion.\n\n- Accepts 1 or many document_ids\n- Returns immediately with \"queued\" status\n- Processes files asynchronously in parallel\n- Check /documents/{topic_id} for status updates","operationId":"ingest_documents_ingest_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/topics":{"post":{"summary":"Create Topic","description":"Create a new topic for a user.","operationId":"create_topic_topics_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TopicCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TopicResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/topics/{user_id}":{"get":{"summary":"List Topics","description":"List all topics for a user.","operationId":"list_topics_topics__user_id__get","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/topics/{topic_id}":{"delete":{"summary":"Delete Topic","description":"Delete a topic and ALL associated data:\n- All documents in the topic\n- All vectors in Pinecone for those documents\n- The topic itself","operationId":"delete_topic_topics__topic_id__delete","parameters":[{"name":"topic_id","in":"path","required":true,"schema":{"type":"string","title":"Topic Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/documents/{document_id}":{"delete":{"summary":"Delete Document","description":"Delete a single document and its vectors from Pinecone.","operationId":"delete_document_documents__document_id__delete","parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"string","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/documents/{topic_id}":{"get":{"summary":"List Documents","description":"List all documents in a topic with their processing status.","operationId":"list_documents_documents__topic_id__get","parameters":[{"name":"topic_id","in":"path","required":true,"schema":{"type":"string","title":"Topic Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/documents/{document_id}/status":{"get":{"summary":"Get Document Status","description":"Get detailed processing status for a single document.\n\nUse this to poll for progress updates during ingestion.\nFrontend should poll every 5 seconds while status is 'processing'.","operationId":"get_document_status_documents__document_id__status_get","parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"string","title":"Document Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentStatus"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_upload_file_upload_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"}},"type":"object","required":["file"],"title":"Body_upload_file_upload_post"},"DocumentStatus":{"properties":{"document_id":{"type":"string","title":"Document Id"},"file_name":{"type":"string","title":"File Name"},"status":{"type":"string","title":"Status"},"processing_stage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Processing Stage"},"progress_percent":{"type":"integer","title":"Progress Percent"},"stage_details":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stage Details"},"chunk_count":{"type":"integer","title":"Chunk Count"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["document_id","file_name","status","processing_stage","progress_percent","stage_details","chunk_count","created_at"],"title":"DocumentStatus"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IngestRequest":{"properties":{"document_ids":{"items":{"type":"string"},"type":"array","title":"Document Ids"}},"type":"object","required":["document_ids"],"title":"IngestRequest"},"IngestResponse":{"properties":{"status":{"type":"string","title":"Status"},"queued_count":{"type":"integer","title":"Queued Count"},"message":{"type":"string","title":"Message"}},"type":"object","required":["status","queued_count","message"],"title":"IngestResponse"},"TopicCreate":{"properties":{"user_id":{"type":"string","title":"User Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"}},"type":"object","required":["user_id","name"],"title":"TopicCreate"},"TopicResponse":{"properties":{"id":{"type":"string","title":"Id"},"user_id":{"type":"string","title":"User Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"}},"type":"object","required":["id","user_id","name","description"],"title":"TopicResponse"},"UploadResponse":{"properties":{"document_id":{"type":"string","title":"Document Id"},"file_path":{"type":"string","title":"File Path"},"file_name":{"type":"string","title":"File Name"},"user_id":{"type":"string","title":"User Id"},"topic_id":{"type":"string","title":"Topic Id"},"status":{"type":"string","title":"Status"},"message":{"type":"string","title":"Message"}},"type":"object","required":["document_id","file_path","file_name","user_id","topic_id","status","message"],"title":"UploadResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"},"input":{"title":"Input"},"ctx":{"type":"object","title":"Context"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}